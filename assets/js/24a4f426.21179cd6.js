"use strict";(self.webpackChunkwiki=self.webpackChunkwiki||[]).push([[148],{3905:(e,t,n)=>{n.d(t,{Zo:()=>u,kt:()=>c});var a=n(7294);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function r(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var p=a.createContext({}),s=function(e){var t=a.useContext(p),n=t;return e&&(n="function"==typeof e?e(t):l(l({},t),e)),n},u=function(e){var t=s(e.components);return a.createElement(p.Provider,{value:t},e.children)},h={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},d=a.forwardRef((function(e,t){var n=e.components,i=e.mdxType,o=e.originalType,p=e.parentName,u=r(e,["components","mdxType","originalType","parentName"]),d=s(n),c=i,m=d["".concat(p,".").concat(c)]||d[c]||h[c]||o;return n?a.createElement(m,l(l({ref:t},u),{},{components:n})):a.createElement(m,l({ref:t},u))}));function c(e,t){var n=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var o=n.length,l=new Array(o);l[0]=d;var r={};for(var p in t)hasOwnProperty.call(t,p)&&(r[p]=t[p]);r.originalType=e,r.mdxType="string"==typeof e?e:i,l[1]=r;for(var s=2;s<o;s++)l[s]=n[s];return a.createElement.apply(null,l)}return a.createElement.apply(null,n)}d.displayName="MDXCreateElement"},2576:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>p,contentTitle:()=>l,default:()=>h,frontMatter:()=>o,metadata:()=>r,toc:()=>s});var a=n(7462),i=(n(7294),n(3905));const o={},l="Setup for developing PyQGIS plugins",r={unversionedId:"python/pyqgis-setup",id:"python/pyqgis-setup",title:"Setup for developing PyQGIS plugins",description:"This article helps to set up the development environment for building QGIS Python plugins.",source:"@site/docs-howto/python/pyqgis-setup.md",sourceDirName:"python",slug:"/python/pyqgis-setup",permalink:"/howto/python/pyqgis-setup",draft:!1,editUrl:"https://github.com/bennetrr/wiki/edit/main/docs-howto/python/pyqgis-setup.md",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Minecraft Game Mechanics",permalink:"/howto/minecraft/game-mechanics"}},p={},s=[{value:"Prerequisites",id:"prerequisites",level:2},{value:"OSGeo4W Environment Shell",id:"osgeo4w-environment-shell",level:2},{value:"<code>pb_tool</code>",id:"pb_tool",level:2},{value:"PyCharm",id:"pycharm",level:2},{value:"QGIS",id:"qgis",level:2},{value:"Create a new plugin",id:"create-a-new-plugin",level:2},{value:"Deploying",id:"deploying",level:2},{value:"Resources",id:"resources",level:2}],u={toc:s};function h(e){let{components:t,...o}=e;return(0,i.kt)("wrapper",(0,a.Z)({},u,o,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"setup-for-developing-pyqgis-plugins"},"Setup for developing PyQGIS plugins"),(0,i.kt)("p",null,"This article helps to set up the development environment for building QGIS Python plugins."),(0,i.kt)("admonition",{type:"note"},(0,i.kt)("p",{parentName:"admonition"},"These instructions only work for Windows (yet)!")),(0,i.kt)("h2",{id:"prerequisites"},"Prerequisites"),(0,i.kt)("p",null,"It's important that you have an up-to-date QGIS installation that was created with the ",(0,i.kt)("a",{parentName:"p",href:"https://qgis.org/en/site/forusers/alldownloads.html#osgeo4w-installer"},(0,i.kt)("inlineCode",{parentName:"a"},"OSGeo4W Network Installer")),".\nIf you already installed QGIS with the standalone installer, remove it and install QGIS again using ",(0,i.kt)("inlineCode",{parentName:"p"},"OSGeo4W"),".\nIf you already installed QGIS with ",(0,i.kt)("inlineCode",{parentName:"p"},"OSGeo4W"),", it's best to update the installation by running the installer again (which can be started by the script ",(0,i.kt)("inlineCode",{parentName:"p"},"C:\\OSGeo4W\\bin\\setup.bat"),")."),(0,i.kt)("p",null,"During the installation process make sure to set these parameters right:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"The root directory has to be ",(0,i.kt)("inlineCode",{parentName:"li"},"C:\\OSGeo4W")),(0,i.kt)("li",{parentName:"ul"},"You need to select the following packages:",(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"Desktop -> qgis: QGIS Desktop")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"Libs -> qt5-devel"))))),(0,i.kt)("p",null,"You also should install ",(0,i.kt)("a",{parentName:"p",href:"https://www.7-zip.org/download.html"},"7-zip"),", so that ",(0,i.kt)("inlineCode",{parentName:"p"},"pb_tool")," is able to package your plugin.\nMake sure the installation directory is ",(0,i.kt)("inlineCode",{parentName:"p"},"C:\\Program Files\\7-Zip"),"."),(0,i.kt)("h2",{id:"osgeo4w-environment-shell"},"OSGeo4W Environment Shell"),(0,i.kt)("p",null,"Next you need a script that adds the QGIS directories to the PATH variable, so you can use QGIS tools and Python libraries.\nSave the script below as ",(0,i.kt)("inlineCode",{parentName:"p"},"C:\\OSGeo4W\\shell.cmd"),"."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-batch",metastring:'title="C:\\OSGeo4W\\shell.cmd"',title:'"C:\\OSGeo4W\\shell.cmd"'},'@echo off\nSET OSGEO4W_ROOT=C:\\OSGeo4W\ncall "%OSGEO4W_ROOT%"\\bin\\o4w_env.bat\ncall "%OSGEO4W_ROOT%"\\apps\\grass\\grass78\\etc\\env.bat\n\n@echo off\npath %PATH%;%OSGEO4W_ROOT%\\apps\\qgis\\bin\npath %PATH%;%OSGEO4W_ROOT%\\apps\\grass\\grass-7.4.0\\lib\npath %PATH%;C:\\OSGeo4W\\apps\\Qt5\\bin\npath %PATH%;C:\\OSGeo4W\\apps\\Python39\\Scripts\npath %PATH%;C:\\Program Files\\7-Zip\n\nset PYTHONPATH=%PYTHONPATH%;%OSGEO4W_ROOT%\\apps\\qgis\\python\nset PYTHONHOME=%OSGEO4W_ROOT%\\apps\\Python39\n\ncmd\n')),(0,i.kt)("p",null,"You can also add this script as a profile in Windows Terminal for easier access."),(0,i.kt)("p",null,"To test if everything works, run the script and execute ",(0,i.kt)("inlineCode",{parentName:"p"},"pip -V"),".\nThe output should contain a path that starts with ",(0,i.kt)("inlineCode",{parentName:"p"},"C:\\OSGwo4W\\"),"."),(0,i.kt)("h2",{id:"pb_tool"},(0,i.kt)("inlineCode",{parentName:"h2"},"pb_tool")),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"pb_tool")," is a CLI tool that helps with compiling, deploying and testing your plugin."),(0,i.kt)("p",null,"To install it, open the OSGeo4W Shell and run ",(0,i.kt)("inlineCode",{parentName:"p"},"pip install pb_tool"),".\nYou can check the installation with ",(0,i.kt)("inlineCode",{parentName:"p"},"pb_tool version"),"."),(0,i.kt)("h2",{id:"pycharm"},"PyCharm"),(0,i.kt)("p",null,"This article is written for ",(0,i.kt)("a",{parentName:"p",href:"https://www.jetbrains.com/pycharm/"},"PyCharm"),", but you can use any other Python IDE (or even a text editor) for developing your plugins."),(0,i.kt)("p",null,"The script below is basically the same as the one that starts the OSGeo4W Shell, but it starts your IDE instead of ",(0,i.kt)("inlineCode",{parentName:"p"},"cmd"),"."),(0,i.kt)("p",null,"Save the script to ",(0,i.kt)("inlineCode",{parentName:"p"},"C:\\OSGeo4W\\pycharm.cmd")," (or the name of your IDE).\nMake sure to change the path to the executable of your IDE installation."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-batch"},'@echo off\nSET OSGEO4W_ROOT=C:\\OSGeo4W\ncall "%OSGEO4W_ROOT%"\\bin\\o4w_env.bat\ncall "%OSGEO4W_ROOT%"\\apps\\grass\\grass78\\etc\\env.bat\n\n@echo off\npath %PATH%;%OSGEO4W_ROOT%\\apps\\qgis\\bin\npath %PATH%;%OSGEO4W_ROOT%\\apps\\grass\\grass-7.4.0\\lib\npath %PATH%;C:\\OSGeo4W\\apps\\Qt5\\bin\npath %PATH%;C:\\OSGeo4W\\apps\\Python39\\Scripts\npath %PATH%;C:\\Program Files\\7-Zip\n\nset PYTHONPATH=%PYTHONPATH%;%OSGEO4W_ROOT%\\apps\\qgis\\python\nset PYTHONHOME=%OSGEO4W_ROOT%\\apps\\Python39\n\nC:\\Users\\benne\\AppData\\Local\\JetBrains\\ToolboxScripts\\pycharm.cmd\n')),(0,i.kt)("h2",{id:"qgis"},"QGIS"),(0,i.kt)("p",null,"There are a few helpful plugins that you should install:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"First Aid")," - Provides a debugger for your code inside QGIS"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"Plugin Builder 3")," - Creates QGIS plugin projects"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"Plugin Reloader")," - Lets you reload your plugin so that you don't have to restart QGIS after making changes")),(0,i.kt)("p",null,"It's also a good idea to open the message dock. Here is a screenshot of my QGIS setup:"),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"Screenshot of QGIS",src:n(428).Z,width:"3839",height:"2089"})),(0,i.kt)("h2",{id:"create-a-new-plugin"},"Create a new plugin"),(0,i.kt)("p",null,"The ",(0,i.kt)("inlineCode",{parentName:"p"},"Plugin Builder")," icon found in the toolbar opens a form where you have to fill in information like plugin name, description and version.\nThe tooltips explain the most options. Here are some additional notes:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Class name, plugin name and module name should be the same but in different formats:\nThe class name should be in ",(0,i.kt)("inlineCode",{parentName:"li"},"CamelCase"),", the plugin name can contain spaces and the module name is ",(0,i.kt)("inlineCode",{parentName:"li"},"lowercase_with_underscores"),"."),(0,i.kt)("li",{parentName:"ul"},"Although the tooltip of the version number says that it accepts semver (",(0,i.kt)("inlineCode",{parentName:"li"},"1.0.0"),"), you have to enter a decimal number."),(0,i.kt)("li",{parentName:"ul"},"The additional components don't have tooltips, but the options are described in the documentation:",(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},"Internationalization: Scripts for translating your plugin"),(0,i.kt)("li",{parentName:"ul"},"Unit tests: A basic set of unit tests"),(0,i.kt)("li",{parentName:"ul"},"Helper scripts: Helper scripts for publishing to the QGIS plugin repository"),(0,i.kt)("li",{parentName:"ul"},"Makefile: Makefile for building the plugin (not needed because we're using ",(0,i.kt)("inlineCode",{parentName:"li"},"pb_tool"),")"),(0,i.kt)("li",{parentName:"ul"},"pb_tool: Configuration for ",(0,i.kt)("inlineCode",{parentName:"li"},"pb_tool"))))),(0,i.kt)("p",null,"After you generated the base plugin, start the OSGeo4W PyCharm and open the folder that was created by the ",(0,i.kt)("inlineCode",{parentName:"p"},"Plugin Builder"),"."),(0,i.kt)("p",null,"Make sure to select the Python interpreter that comes with QGIS (it starts with ",(0,i.kt)("inlineCode",{parentName:"p"},"C:\\OSGeo4W\\"),")."),(0,i.kt)("h2",{id:"deploying"},"Deploying"),(0,i.kt)("p",null,"To test the plugin, you have to compile and copy the files into the QGIS plugin directory.\nTo do this, just run the command ",(0,i.kt)("inlineCode",{parentName:"p"},"pb_tool deploy"),".\nAfter that, you should be able to enable the plugin in QGIS.\nAfter making changes and deploying them, you can reload the plugin using the ",(0,i.kt)("inlineCode",{parentName:"p"},"Plugin Reloader")," (you first need to set your plugin in the configuration menu)."),(0,i.kt)("p",null,"If you create new files that should be included in the plugin, you need to add them into the ",(0,i.kt)("inlineCode",{parentName:"p"},"pb_tool.cfg"),"."),(0,i.kt)("p",null,"The ",(0,i.kt)("inlineCode",{parentName:"p"},"*.ui")," files can be opened with the QT Designer that was installed along QGIS.\nYou can also open the ",(0,i.kt)("inlineCode",{parentName:"p"},"resources.qrc")," file with the ressource browser of the designer."),(0,i.kt)("h2",{id:"resources"},"Resources"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://docs.qgis.org/3.22/en/docs/pyqgis_developer_cookbook/index.html"},"Official PyQGIS Cookbook")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://qgis.org/pyqgis/3.22/"},"PyQGIS API Docs")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://github.com/g-sherman/plugin_build_tool#usage"},(0,i.kt)("inlineCode",{parentName:"a"},"pb_tool")," Usage"))),(0,i.kt)("p",null,"Source: ",(0,i.kt)("a",{parentName:"p",href:"https://spatialgalaxy.net/2018/02/13/quick-guide-to-getting-started-with-pyqgis-3-on-windows/"},"Quick guide to getting started with PyQGIS3 on Windows | Spatial Galaxy")))}h.isMDXComponent=!0},428:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/qgis_setup-4799040d63b75e3f2fca6fce76593fa4.png"}}]);